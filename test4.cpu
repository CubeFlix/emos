# Heap Memory Function Test

JMP SYM[main]

[func]
ARGN REG[RAX, [0x0] : [0x4]], [0x0]
MOV REG[RBX, [0x0] : [0x4]], HEAP[REG[RAX, [0x0] : [0x4]], [0x0] : [0x4]]
MOV REG[RCX, [0x0] : [0x4]], HEAP[REG[RAX, [0x0] : [0x4]], [0x4] : [0x4]]
ADD REG[RBX, [0x0] : [0x4]], REG[RCX, [0x0] : [0x4]], HEAP[REG[RAX, [0x0] : [0x4]], [0x0] : [0x4]]
SUB REG[RBX, [0x0] : [0x4]], REG[RCX, [0x0] : [0x4]], HEAP[REG[RAX, [0x0] : [0x4]], [0x4] : [0x4]]
MUL REG[RBX, [0x0] : [0x4]], REG[RCX, [0x0] : [0x4]], HEAP[REG[RAX, [0x0] : [0x4]], [0x8] : [0x4]]
DIV REG[RBX, [0x0] : [0x4]], REG[RCX, [0x0] : [0x4]], HEAP[REG[RAX, [0x0] : [0x4]], [0xc] : [0x4]], REG[R9, [0x0] : [0x4]]
MOV REG[RAX, [0x0] : [0x1]], [0x0]
RET

[malloc]
MOV REG[RAX, [0x0] : [0x1]], [1d15]
SYS
EIR
MOV REG[RAX, [0x0] : [0x4]], REG[RBX, [0x0] : [0x4]]
RET

[main]
CALL SYM[malloc]
MOV HEAP[REG[RAX, [0x0] : [0x4]], [0x0] : [0x4]], [4]
MOV HEAP[REG[RAX, [0x0] : [0x4]], [0x4] : [0x4]], [2]
PUSH REG[RAX, [0x0] : [0x4]]
CALL SYM[func]
POPR
HLT [0x0]